{
  "id": "c4_l1",
  "title": "OWASP Top 10 & Ransomware",
  "description": "Caso Real: Colonial Pipeline (2021)",
  "type": "interactive",
  "duration_minutes": 25,
  "xp_reward": 60,
  "order_index": 1,
  "course_id": 4,
  "total_screens": 18,
  "theme": {
    "primary_color": "#D32F2F",
    "secondary_color": "#FF6F00",
    "accent_color": "#388E3C",
    "gradient": ["#1a0000", "#330000", "#4d0000"]
  },
  "screens": [
    {
      "screen_id": 1,
      "type": "story_intro",
      "title": "Operaci√≥n: Pipeline Down",
      "content": {
        "headline": "MAYO 2021",
        "subheadline": "DarkSide ransomware paraliza 45% del combustible East Coast US",
        "stats": [
          {"value": "$4.4M", "label": "Ransom pagado"},
          {"value": "6 d√≠as", "label": "Pipeline offline"},
          {"value": "5,500", "label": "Miles de pipeline"}
        ],
        "cta_text": "Investigar Breach"
      }
    },
    {
      "screen_id": 2,
      "type": "story_slide",
      "title": "Critical Infrastructure Target",
      "content": {
        "icon": "local_gas_station",
        "icon_color": "#FF6F00",
        "headline": "Colonial Pipeline: Single Point of Failure",
        "body": "Colonial Pipeline suministra 45% del combustible East Coast (gasolina, diesel, jet fuel). 5,500 miles desde Texas a New York. DarkSide (ransomware-as-a-service gang) targeted critical infrastructure sabiendo que Colonial MUST pay para restore service. $4.4M ransom < impact econ√≥mico.",
        "highlight_box": {
          "type": "danger",
          "text": "Root cause: Leaked VPN password (no MFA) + segmentation faltante entre IT y OT (Operational Technology). Attack vector: A01:2021 Broken Access Control."
        }
      }
    },
    {
      "screen_id": 3,
      "type": "crisis_timeline",
      "title": "‚è±Ô∏è RANSOMWARE DEPLOYMENT",
      "content": {
        "events": [
          {
            "time": "Apr 2021",
            "icon": "vpn_key",
            "title": "VPN Credential Leak",
            "description": "Colonial employee password leaked en dark web (credential dump anterior). Password reused across systems. VPN account SIN MFA.",
            "severity": "warning"
          },
          {
            "time": "May 7 00:00",
            "icon": "login",
            "title": "Lateral Movement",
            "description": "Attackers login VPN con stolen credentials. Lateral movement en IT network. No network segmentation detecta anomalous access.",
            "severity": "critical"
          },
          {
            "time": "May 7 05:00",
            "icon": "bug_report",
            "title": "DarkSide Deployment",
            "description": "DarkSide ransomware deployed. IT systems (billing, email, corporate) encrypted. Ransom note left: 75 Bitcoin ($4.4M) demanded.",
            "severity": "critical"
          },
          {
            "time": "May 7 06:00",
            "icon": "power_off",
            "title": "Shutdown Decision",
            "description": "CEO decide shutdown preventivo de ENTIRE pipeline. Fear: ransomware spread a OT systems (SCADA). Explosion risk > economic loss.",
            "severity": "critical"
          },
          {
            "time": "May 7 12:00",
            "icon": "payments",
            "title": "Ransom Payment",
            "description": "Colonial paga 75 BTC ($4.4M) en horas. DarkSide entrega decryption key (lento, barely usable). Backups hubieran sido m√°s r√°pidos.",
            "severity": "critical"
          },
          {
            "time": "May 13",
            "icon": "restore",
            "title": "Restoration",
            "description": "Pipeline gradual restart. 6 d√≠as offline. East Coast fuel panic, gas stations empty, airlines canceladas. FBI recupera $2.3M (seized DarkSide wallet).",
            "severity": "warning"
          }
        ]
      }
    },
    {
      "screen_id": 4,
      "type": "crisis_decision",
      "title": "üö® VPN Security Design",
      "content": {
        "scenario": "Eres CISO pre-Colonial. Engineering wants VPN access para 3rd-party vendors (HVAC, contractors). Security team propone: 1) Password-only (easy), 2) MFA required, 3) Zero Trust (certificate-based). ¬øQu√© decides?",
        "timer_seconds": 35,
        "options": [
          {
            "id": "password_only",
            "text": "Password-only VPN (NIST-compliant 12+ chars)",
            "icon": "password",
            "is_correct": false,
            "consequence": {
              "title": "Esto fue Colonial",
              "description": "Password leaked ‚Üí VPN access ‚Üí ransomware ‚Üí $4.4M ransom + 6 days offline + national emergency. MFA blocks 99.9% credential attacks.",
              "impact_score": -100
            }
          },
          {
            "id": "mfa_vpn",
            "text": "MFA mandatory (TOTP/hardware key) + time-based access",
            "icon": "verified_user",
            "is_correct": true,
            "consequence": {
              "title": "Defense in Depth",
              "description": "Even si password leaked, MFA blocks access. Time-based: VPN expires after work hours. Least privilege: Vendors access ONLY necessary systems. Colonial breach prevented.",
              "impact_score": 100,
              "xp_bonus": 30
            }
          },
          {
            "id": "zero_trust",
            "text": "Zero Trust: mTLS certificates + device posture check + micro-segmentation",
            "icon": "security",
            "is_correct": false,
            "consequence": {
              "title": "Over-Engineering",
              "description": "Zero Trust es ideal PERO expensive y complex. mTLS + posture checks = $200K+ implementation. MFA sufficient para most orgs. ZT para large enterprises.",
              "impact_score": 70
            }
          }
        ]
      }
    },
    {
      "screen_id": 5,
      "type": "flip_card_full",
      "title": "OWASP Top 10: 2021 Edition",
      "content": {
        "card": {
          "front": {
            "icon": "security",
            "term": "OWASP TOP 10",
            "subtitle": "Web app security risks",
            "color": "#D32F2F"
          },
          "back": {
            "definition": "OWASP (Open Web Application Security Project): Non-profit, industry standard para web security. Top 10 = most critical web app risks, updated every 3-4 years.",
            "top_10_2021": [
              "A01: Broken Access Control (Colonial: no MFA VPN)",
              "A02: Cryptographic Failures (sensitive data exposure)",
              "A03: Injection (SQL, XSS, command injection)",
              "A04: Insecure Design (lack of security requirements)",
              "A05: Security Misconfiguration",
              "A06: Vulnerable Components (outdated libraries)",
              "A07: Identification & Authentication Failures",
              "A08: Software & Data Integrity Failures",
              "A09: Security Logging & Monitoring Failures",
              "A10: Server-Side Request Forgery (SSRF)"
            ],
            "usage": "Use OWASP Top 10 como checklist en SDLC. Code reviews, pentests, security requirements.",
            "color": "#C62828"
          }
        }
      }
    },
    {
      "screen_id": 6,
      "type": "flip_card_full",
      "title": "A01: Broken Access Control",
      "content": {
        "card": {
          "front": {
            "icon": "lock_open",
            "term": "BROKEN ACCESS CONTROL",
            "subtitle": "Users do things they shouldn't",
            "color": "#E65100"
          },
          "back": {
            "definition": "Users pueden access resources o perform actions beyond intended permissions. Bypassing access checks, privilege escalation, IDOR (Insecure Direct Object Reference).",
            "examples": [
              "Colonial: VPN sin MFA = broken access (leaked creds functional)",
              "URL manipulation: /user/123 ‚Üí /user/124 (see other user data)",
              "Missing authorization: API checks authentication pero NOT authorization",
              "Privilege escalation: Regular user ‚Üí admin via parameter tampering"
            ],
            "mitigation": "Deny by default. Enforce access control server-side (never client). MFA para sensitive actions. Log access attempts.",
            "colonial_lesson": "MFA hubiera prevented VPN access even con leaked password. Access control = authentication + authorization.",
            "color": "#D84315"
          }
        }
      }
    },
    {
      "screen_id": 7,
      "type": "flip_card_full",
      "title": "Ransomware-as-a-Service (RaaS)",
      "content": {
        "card": {
          "front": {
            "icon": "store",
            "term": "RaaS",
            "subtitle": "Ransomware business model",
            "color": "#6A1B9A"
          },
          "back": {
            "definition": "Ransomware-as-a-Service: Developers create ransomware, affiliates deploy it. Revenue split (70-80% affiliate, 20-30% developer). Lowers barrier to entry.",
            "darkside_model": "DarkSide: Professional operation. Avoided hospitals, schools (PR). Targeted high-value (Colonial). Customer support (decryption help). 24/7 negotiation.",
            "ecosystem": [
              "Access brokers: Sell compromised credentials (VPNs, RDP)",
              "Ransomware operators: Deploy malware",
              "Data leak sites: Pressure victims (double extortion)",
              "Cryptocurrency mixers: Launder Bitcoin payments"
            ],
            "defense": "Prevent initial access (MFA, patching). Segment networks. Offline backups. IR plan.",
            "color": "#4A148C"
          }
        }
      }
    },
    {
      "screen_id": 8,
      "type": "flip_card_full",
      "title": "IT/OT Segmentation",
      "content": {
        "card": {
          "front": {
            "icon": "lan",
            "term": "IT/OT SEGMENTATION",
            "subtitle": "Isolate operational tech",
            "color": "#1976D2"
          },
          "back": {
            "definition": "IT (Information Tech): Corporate systems (email, billing, HR). OT (Operational Tech): SCADA, ICS, control systems (pipelines, manufacturing, power grids).",
            "why_critical": "OT compromise = physical danger. Pipeline explosion, power outage, chemical spill. OT debe estar air-gapped o heavily segmented de IT.",
            "colonial_gap": "Colonial: IT y OT en same network. CEO shutdowns pipeline por fear de OT spread. Proper segmentation hubiera isolated ransomware a IT only.",
            "implementation": [
              "Firewall between IT/OT zones",
              "No direct internet access desde OT",
              "Jump boxes para OT access (MFA required)",
              "Monitor all IT‚ÜíOT traffic"
            ],
            "color": "#1565C0"
          }
        }
      }
    },
    {
      "screen_id": 9,
      "type": "drag_drop_match",
      "title": "OWASP Top 10 Mapping",
      "content": {
        "instruction": "Match el OWASP category con el vulnerability example:",
        "scenarios": [
          {"id": 1, "text": "VPN sin MFA, leaked password functional", "correct_target": "a01"},
          {"id": 2, "text": "SQL injection: ' OR '1'='1 bypasses login", "correct_target": "a03"},
          {"id": 3, "text": "Password stored en plaintext en database", "correct_target": "a02"},
          {"id": 4, "text": "Using Log4j 2.14 (CVE-2021-44228 Log4Shell)", "correct_target": "a06"},
          {"id": 5, "text": "No logging de failed login attempts", "correct_target": "a09"}
        ],
        "targets": [
          {"id": "a01", "label": "A01: Broken Access Control", "color": "#E65100"},
          {"id": "a02", "label": "A02: Cryptographic Failures", "color": "#7B1FA2"},
          {"id": "a03", "label": "A03: Injection", "color": "#D32F2F"},
          {"id": "a06", "label": "A06: Vulnerable Components", "color": "#1976D2"},
          {"id": "a09", "label": "A09: Logging Failures", "color": "#388E3C"}
        ],
        "xp_per_correct": 7
      }
    },
    {
      "screen_id": 10,
      "type": "swipe_cards",
      "title": "Ransomware Defense: Good Practice?",
      "content": {
        "instruction": "¬øEs esta pr√°ctica efectiva contra ransomware?",
        "cards": [
          {
            "id": 1,
            "scenario": "VPN con MFA + time-based access (8AM-6PM solo)",
            "correct_answer": "right",
            "labels": {"left": "‚ùå INEFECTIVA", "right": "‚úÖ EFECTIVA"}
          },
          {
            "id": 2,
            "scenario": "Backups en same network (accessible desde production)",
            "correct_answer": "left",
            "labels": {"left": "‚ùå INEFECTIVA", "right": "‚úÖ EFECTIVA"}
          },
          {
            "id": 3,
            "scenario": "Network segmentation: IT zone separada de OT zone via firewall",
            "correct_answer": "right",
            "labels": {"left": "‚ùå INEFECTIVA", "right": "‚úÖ EFECTIVA"}
          },
          {
            "id": 4,
            "scenario": "Pagar ransom es fastest recovery method",
            "correct_answer": "left",
            "labels": {"left": "‚ùå INEFECTIVA", "right": "‚úÖ EFECTIVA"}
          },
          {
            "id": 5,
            "scenario": "Offline backups (air-gapped), tested quarterly",
            "correct_answer": "right",
            "labels": {"left": "‚ùå INEFECTIVA", "right": "‚úÖ EFECTIVA"}
          }
        ],
        "xp_per_correct": 9
      }
    },
    {
      "screen_id": 11,
      "type": "flip_card_full",
      "title": "Incident Response Phases",
      "content": {
        "card": {
          "front": {
            "icon": "emergency",
            "term": "IR LIFECYCLE",
            "subtitle": "NIST 800-61 framework",
            "color": "#388E3C"
          },
          "back": {
            "definition": "NIST 800-61: Computer Security Incident Handling Guide. 4 phases: Preparation, Detection & Analysis, Containment/Eradication/Recovery, Post-Incident.",
            "phases": [
              "1. Preparation: IR plan, CSIRT team, tools, playbooks, training",
              "2. Detection & Analysis: SIEM alerts, triage, scope assessment",
              "3. Containment: Short-term (isolate), Long-term (patch, rebuild)",
              "4. Eradication: Remove malware, close vulnerabilities",
              "5. Recovery: Restore systems, monitor for reinfection",
              "6. Post-Incident: Lessons learned, update IR plan"
            ],
            "colonial_gaps": "No tested backups (recovery slow). No IT/OT segmentation (containment hard). MFA absent (prevention fail).",
            "color": "#2E7D32"
          }
        }
      }
    },
    {
      "screen_id": 12,
      "type": "log_hunter",
      "title": "üîç Hunt: VPN Anomalous Login",
      "content": {
        "scenario": "Investigas Colonial breach. VPN logs muestran logins. Find las 2 lines sospechosas que indican compromised credentials.",
        "log_lines": [
          {"id": 1, "text": "2021-05-06 08:23:11 VPN_LOGIN user=john.smith@colonial.com src_ip=203.45.12.8 (Richmond, VA) result=success MFA=true", "is_suspicious": false},
          {"id": 2, "text": "2021-05-07 00:45:33 VPN_LOGIN user=contractor_hvac@colonial.com src_ip=185.220.101.14 (Moscow, Russia) result=success MFA=false", "is_suspicious": true, "reason": "HVAC contractor login desde Russia 12AM + no MFA = compromised credentials"},
          {"id": 3, "text": "2021-05-07 01:12:17 VPN_LOGIN user=contractor_hvac@colonial.com src_ip=185.220.101.14 multiple_failed_attempts=15 previous_hour result=success", "is_suspicious": true, "reason": "15 failed attempts followed por success = credential stuffing attack"},
          {"id": 4, "text": "2021-05-07 09:15:42 VPN_LOGIN user=admin@colonial.com src_ip=172.16.0.5 (HQ) result=success MFA=true", "is_suspicious": false},
          {"id": 5, "text": "2021-05-07 14:33:29 VPN_LOGIN user=jane.doe@colonial.com src_ip=98.12.34.56 (Atlanta, GA) result=success MFA=true", "is_suspicious": false}
        ],
        "xp_reward": 25
      }
    },
    {
      "screen_id": 13,
      "type": "slider_balance",
      "title": "‚öñÔ∏è Estrategia de Backup",
      "content": {
        "scenario": "¬øC√≥mo proteges los datos cr√≠ticos ante Ransomware?",
        "left_option": {
          "label": "Sincronizaci√≥n Nube (Live)",
          "icon": "cloud_upload",
          "consequences": [
            "‚úÖ Copia instant√°nea",
            "‚ùå El ransomware tambi√©n se sincroniza",
            "‚ùå Archivos cifrados sobrescriben los buenos"
          ]
        },
        "right_option": {
          "label": "Backup Inmutable / Offline",
          "icon": "save",
          "consequences": [
            "‚úÖ A prueba de ransomware",
            "‚úÖ Recuperaci√≥n garantizada",
            "‚ùå Gesti√≥n m√°s compleja"
          ]
        },
        "explanation": "Para ransomware, solo sirve lo inmutable o desconectado (Offline). Si tu PC puede escribir en el backup, el virus tambi√©n puede."
      }
    },
    {
      "screen_id": 14,
      "type": "timed_quiz",
      "title": "‚ö° Colonial Root Cause",
      "content": {
        "timer_seconds": 30,
        "question": "¬øCu√°l fue el root cause M√ÅS cr√≠tico del Colonial Pipeline breach?",
        "options": [
          {"id": "a", "text": "DarkSide ransomware era muy sophisticated", "is_correct": false},
          {"id": "b", "text": "VPN sin MFA + leaked password = broken access control (OWASP A01)", "is_correct": true},
          {"id": "c", "text": "Colonial no ten√≠a firewall", "is_correct": false}
        ],
        "explanation": "Root cause: Broken Access Control (OWASP A01). VPN sin MFA + leaked password (dark web) = attacker login. Secondary: No IT/OT segmentation. MFA hubiera blocked attack even con leaked password.",
        "xp_reward": 20
      }
    },
    {
      "screen_id": 15,
      "type": "timed_quiz",
      "title": "‚ö° OWASP Top 10 Purpose",
      "content": {
        "timer_seconds": 25,
        "question": "¬øQu√© es OWASP Top 10 y c√≥mo se usa?",
        "options": [
          {"id": "a", "text": "List de top 10 hacking tools", "is_correct": false},
          {"id": "b", "text": "Industry-standard checklist de most critical web app security risks para SDLC", "is_correct": true},
          {"id": "c", "text": "Ranking de top 10 hackers", "is_correct": false}
        ],
        "explanation": "OWASP Top 10: Awareness document sobre most critical web app security risks. Updated cada 3-4 a√±os. Use como: Security requirements, code review checklist, pentesting scope, developer training.",
        "xp_reward": 20
      }
    },
    {
      "screen_id": 16,
      "type": "timed_quiz",
      "title": "‚ö° Ransomware Payment",
      "content": {
        "timer_seconds": 30,
        "question": "Colonial pag√≥ $4.4M ransom. ¬øPor qu√© esto NO fue optimal strategy?",
        "options": [
          {"id": "a", "text": "Pagar ransom es illegal", "is_correct": false},
          {"id": "b", "text": "Decryption key fue lento/unreliable. Backups hubieran sido faster. Pagar funds criminal gangs.", "is_correct": true},
          {"id": "c", "text": "FBI siempre recupera ransoms", "is_correct": false}
        ],
        "explanation": "Ransomware payment issues: 1) No garantiza working decryption key (DarkSide key fue slow), 2) Funds organized crime, 3) Encourages future attacks. Backups + IR plan > paying ransom. FBI recovered solo $2.3M de $4.4M.",
        "xp_reward": 20
      }
    },
    {
      "screen_id": 17,
      "type": "achievement_unlock",
      "title": "Logro Desbloqueado",
      "content": {
        "achievement": {
          "icon": "security",
          "name": "OWASP Security Expert",
          "description": "Master OWASP Top 10 & ransomware defense strategies",
          "rarity": "rare",
          "color": "#D32F2F"
        }
      }
    },
    {
      "screen_id": 18,
      "type": "lesson_complete",
      "title": "Lecci√≥n Completada",
      "content": {
        "xp_earned": 60,
        "key_takeaways": [
          "Colonial Pipeline: $4.4M ransom, 6 days offline. Root cause: VPN sin MFA (OWASP A01)",
          "OWASP Top 10: Industry-standard web app security risks. Use en SDLC.",
          "A01 Broken Access Control: MFA mandatory, least privilege, server-side enforcement",
          "Ransomware-as-a-Service: Professional operations (DarkSide). Access brokers + affiliates.",
          "IT/OT Segmentation: Isolate operational tech. Colonial lacked this = shutdown fear.",
          "Defense: MFA, network segmentation, offline backups, IR plan tested"
        ],
        "next_lesson": {
          "id": "c4_l2",
          "title": "SQL Injection",
          "preview": "Caso Target POS Breach - Supply chain + SQL injection"
        }
      }
    }
  ]
}