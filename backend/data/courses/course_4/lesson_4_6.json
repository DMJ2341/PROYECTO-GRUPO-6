{
  "id": "c4_l6",
  "title": "Seguridad de contenedores",
  "description": "Caso Real: Tesla Kubernetes Breach (2018)",
  "type": "interactive",
  "duration_minutes": 28,
  "xp_reward": 70,
  "order_index": 6,
  "course_id": 4,
  "total_screens": 20,
  "theme": {
    "primary_color": "#F57C00",
    "secondary_color": "#03A9F4",
    "accent_color": "#8BC34A",
    "gradient": ["#331900", "#663300", "#994d00"]
  },
  "screens": [
    {
      "screen_id": 1,
      "type": "story_intro",
      "title": "Operaci√≥n: CryptoJacking Tesla",
      "content": {
        "headline": "FEBRERO 2018",
        "subheadline": "Kubernetes console sin contrase√±a ‚Üí criptominer√≠a masiva",
        "stats": [
          {"value": "100%", "label": "CPUs al m√°ximo"},
          {"value": "$3k+", "label": "Factura AWS"},
          {"value": "0 d√≠as", "label": "Con contrase√±a"}
        ],
        "cta_text": "Investigar K8s Breach"
      }
    },
    {
      "screen_id": 2,
      "type": "story_slide",
      "title": "K8s Dashboard expuesto",
      "content": {
        "icon": "dashboard",
        "icon_color": "#F57C00",
        "headline": "Tesla dej√≥ console Kubernetes p√∫blica sin auth",
        "body": "Attacker escanea internet ‚Üí encuentra kube-dashboard.exp√≥sito. Sin contrase√±a, sin RBAC. Acceso total al cluster. Despliega criptomineros en todos los pods. Factura AWS se dispara. Credenciales internas expuestas en configuraci√≥n.",
        "highlight_box": {
          "type": "danger",
          "text": "Lecci√≥n: Cloud + containers no son seguros por defecto. Todo necesita defensa expl√≠cita."
        }
      }
    },
    {
      "screen_id": 3,
      "type": "crisis_timeline",
      "title": "‚è±Ô∏è TESLA K8S BREACH",
      "content": {
        "events": [
          {
            "time": "2017",
            "icon": "build",
            "title": "Tesla migra a Kubernetes",
            "description": "Dashboard instalado con configuraci√≥n default.",
            "severity": "warning"
          },
          {
            "time": "Feb 2018",
            "icon": "public",
            "title": "Dashboard expuesto a internet",
            "description": "Sin auth, sin RBAC, sin NetworkPolicy.",
            "severity": "critical"
          },
          {
            "time": "Feb 2018",
            "icon": "currency_bitcoin",
            "title": "Criptominer√≠a desplegada",
            "description": "Mineros en todos los nodos. AWS bill explota.",
            "severity": "critical"
          },
          {
            "time": "Feb 2018",
            "icon": "report",
            "title": "Red Team descubre breach",
            "description": "Investigaci√≥n revela credenciales internas en config.",
            "severity": "critical"
          }
        ]
      }
    },
    {
      "screen_id": 4,
      "type": "flip_card_full",
      "title": "Container Attack Surface",
      "content": {
        "card": {
          "front": {"icon": "warning", "term": "ATAQUE CONTAINERS", "subtitle": "7 capas de riesgo", "color": "#F57C00"},
          "back": {
            "layers": [
              "1. Imagen vulnerable (CVE)",
              "2. Container escape (host breakout)",
              "3. Secrets en plaintext",
              "4. Privilegios innecesarios",
              "5. Configuraci√≥n insegura (Docker socket)",
              "6. Red expuesta",
              "7. Orquestador mal configurado (K8s RBAC)"
            ],
            "color": "#EF6C00"
          }
        }
      }
    },
    {
      "screen_id": 5,
      "type": "flip_card_full",
      "title": "Im√°genes Confiables",
      "content": {
        "card": {
          "front": {"icon": "verified", "term": "IM√ÅGENES SEGURAS", "subtitle": "No FROM scratch siempre", "color": "#8BC34A"},
          "back": {
            "best_practices": [
              "Base images oficiales y minimalistas (alpine, distroless)",
              "Multi-stage builds",
              "USER non-root",
              "No secrets en Dockerfile",
              "Firmar im√°genes (cosign, notary)"
            ],
            "color": "#689F38"
          }
        }
      }
    },
    {
      "screen_id": 6,
      "type": "flip_card_full",
      "title": "RBAC + NetworkPolicy",
      "content": {
        "card": {
          "front": {"icon": "policy", "term": "RBAC K8s", "subtitle": "Least privilege", "color": "#03A9F4"},
          "back": {
            "defense": "Roles y ClusterRoles m√≠nimos. Nadie con admin salvo break-glass.",
            "networkpolicy": "Por defecto denegar todo tr√°fico. Allow expl√≠cito.",
            "tesla_fail": "Dashboard con acceso an√≥nimo total",
            "color": "#0288D1"
          }
        }
      }
    },
    {
      "screen_id": 7,
      "type": "flip_card_full",
      "title": "Secrets Management",
      "content": {
        "card": {
          "front": {"icon": "key", "term": "SECRETOS", "subtitle": "Nunca en env vars", "color": "#E91E63"},
          "back": {
            "tools": "HashiCorp Vault, AWS Secrets Manager, Sealed Secrets, External Secrets Operator",
            "tesla_leak": "Credenciales AWS en configuraci√≥n de pod",
            "color": "#C2185B"
          }
        }
      }
    },
    {
      "screen_id": 8,
      "type": "flip_card_full",
      "title": "Runtime Security",
      "content": {
        "card": {
          "front": {"icon": "security", "term": "RUNTIME", "subtitle": "Falco, Sysdig, Aqua", "color": "#388E3C"},
          "back": {
            "detecta": "Crypto miners, shell reversa, privilege escalation, container escape",
            "reglas": "Falco rules por defecto + custom",
            "color": "#2E7D32"
          }
        }
      }
    },
    {
      "screen_id": 9,
      "type": "drag_drop_match",
      "title": "K8s Hardening",
      "content": {
        "instruction": "Relaciona control con su funci√≥n:",
        "scenarios": [
          { "id": 1, "text": "Bloquea tr√°fico entre pods", "correct_target": "netpol" },
          { "id": 2, "text": "Evita root en container", "correct_target": "nonroot" },
          { "id": 3, "text": "Detecta cryptojacking", "correct_target": "falco" },
          { "id": 4, "text": "Escanea im√°genes", "correct_target": "trivy" },
          { "id": 5, "text": "Controla qui√©n hace deploy", "correct_target": "rbac" }
        ],
        "targets": [
          { "id": "netpol", "label": "NetworkPolicy", "color": "#03A9F4" },
          { "id": "nonroot", "label": "runAsNonRoot", "color": "#F57C00" },
          { "id": "falco", "label": "Falco", "color": "#D32F2F" },
          { "id": "trivy", "label": "Trivy/Aqua", "color": "#4CAF50" },
          { "id": "rbac", "label": "RBAC", "color": "#9C27B0" }
        ],
        "xp_per_correct": 8
      }
    },
    {
      "screen_id": 10,
      "type": "swipe_cards",
      "title": "Container Security: ¬øSeguro?",
      "content": {
        "instruction": "¬øEs segura esta pr√°ctica?",
        "cards": [
          {"id": 1, "scenario": "Dashboard K8s p√∫blico sin auth", "correct_answer": "left"},
          {"id": 2, "scenario": "PodSecurity Standards enforced", "correct_answer": "right"},
          {"id": 3, "scenario": "Secrets en env vars plaintext", "correct_answer": "left"},
          {"id": 4, "scenario": "Im√°genes escaneadas en CI/CD", "correct_answer": "right"},
          {"id": 5, "scenario": "privileged: true en pod", "correct_answer": "left"}
        ],
        "labels": {"left": "‚ùå INSEGURO", "right": "‚úÖ SEGURO"},
        "xp_per_correct": 10
      }
    },
    {
      "screen_id": 11,
      "type": "log_hunter",
      "title": "üîç Hunt: CryptoMiner",
      "content": {
        "scenario": "Logs Falco. Encuentra las 2 alertas de cryptojacking.",
        "log_lines": [
          {"id": 1, "text": "14:23:11 Normal app startup in pod web-7", "is_suspicious": false},
          {"id": 2, "text": "14:45:33 Shell spawned in container (kstr1d process)", "is_suspicious": true},
          {"id": 3, "text": "14:46:12 High CPU usage + process xmrig detected", "is_suspicious": true},
          {"id": 4, "text": "15:02:15 Normal health check", "is_suspicious": false},
          {"id": 5, "text": "15:15:42 Pod scheduled normally", "is_suspicious": false}
        ],
        "xp_reward": 30
      }
    },
    {
      "screen_id": 12,
      "type": "timed_quiz",
      "title": "‚ö° Tesla Root Cause",
      "content": {
        "timer_seconds": 30,
        "question": "¬øQu√© permiti√≥ el breach de Tesla?",
        "options": [
          { "id": "a", "text": "Vulnerabilidad zero-day en K8s", "is_correct": false },
          { "id": "b", "text": "Dashboard expuesto sin autenticaci√≥n + credenciales en config", "is_correct": true }
        ],
        "explanation": "No fue un hack sofisticado. Fue higiene b√°sica: una consola de administraci√≥n expuesta a todo internet sin contrase√±a. Las credenciales de AWS estaban en texto plano dentro del pod.",
        "xp_reward": 25
      }
    },
    {
      "screen_id": 13,
      "type": "achievement_unlock",
      "title": "Logro Desbloqueado",
      "content": {
        "achievement": {
          "icon": "security",
          "name": "Container Hardened",
          "description": "Master en seguridad de contenedores y Kubernetes",
          "rarity": "epic",
          "color": "#F57C00"
        }
      }
    },
    {
      "screen_id": 14,
      "type": "lesson_complete",
      "title": "Lecci√≥n Completada",
      "content": {
        "xp_earned": 70,
        "key_takeaways": [
          "Tesla 2018: K8s dashboard p√∫blico ‚Üí cryptojacking",
          "7 capas de riesgo en containers",
          "Defensas: RBAC estricto, NetworkPolicy, PodSecurity, non-root, secrets externas",
          "Escaneo im√°genes (Trivy), runtime (Falco), firma im√°genes",
          "Nunca expongas servicios K8s sin auth"
        ],
        "next_lesson": {
          "id": "c4_l7",
          "title": "Evaluaci√≥n Final DevSecOps",
          "preview": "Examen pr√°ctico + te√≥rico"
        }
      }
    }
  ]
}