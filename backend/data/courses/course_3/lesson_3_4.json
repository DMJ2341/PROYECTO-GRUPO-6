[
  {"screen_id":1,"type":"story_hook","title":"Caso Real: Okta Breach 2022","duration":120,"content":{"case_name":"Okta Third-Party Breach","date":"Jan-Mar 2022","image_url":"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Okta_logo.svg/1200px-Okta_logo.svg.png","narrative":"Atacantes comprometieron laptop de soporte engineer en Sitel (contractor de Okta). Acceso a Okta customer support tools. Visualizaron datos de ~375 customers. Riesgo: Okta es SSO provider para miles de empresas - single point of failure. Supply chain risk en IAM.","stats":[{"label":"Customers Afectados","value":"375","icon":"business"},{"label":"Vector","value":"Contractor","icon":"person"},{"label":"Access Duration","value":"5 días","icon":"schedule"}]}},
  {"screen_id":2,"type":"theory_tabs","title":"Identity Lifecycle Management","content":{"intro":"Gestión de identidades desde creación hasta eliminación. Proceso crítico para seguridad y compliance.","tabs":[{"label":"Provisioning","title":"Onboarding - Creación","text":"Nuevo empleado: crear cuentas en AD, email, apps. Asignar a roles. Acceso Day-1. Automatizar con HR system. Joiner workflow. Principio: acceso mínimo inicial, expand as needed.","icon":"person_add"},{"label":"Modification","title":"Cambios - Role Changes","text":"Promoción, cambio dept, cambio responsabilidades. Movers workflow. Re-certificar acceso. Remove old permissions, add new. Risk: permission creep (acumular sin remover).","icon":"edit"},{"label":"Deprovisioning","title":"Offboarding - Eliminación","text":"Empleado sale: deshabilitar cuentas inmediatamente. Revocar acceso físico, VPN, remote. Leaver workflow. 24hr SLA critical. Transfer knowledge/files. Archival de datos. Ghost accounts = risk.","icon":"person_remove"},{"label":"Re-certification","title":"Access Reviews Periódicas","text":"Cada 90-180 días: managers revisan acceso de sus equipos. Confirman que sigue siendo necesario. Remediar excess permissions. Compliance requirement (SOX, GDPR). Automated campaigns.","icon":"fact_check"}]}},
  {"screen_id":3,"type":"theory_section","title":"Single Sign-On (SSO) - SAML & OAuth","content":{"sso_benefits":["User convenience: 1 login → múltiples apps","Security: menos passwords, MFA centralizado","Compliance: audit trail centralizado","Efficiency: menos helpdesk password resets"],"protocols":[{"name":"SAML 2.0","description":"Security Assertion Markup Language. XML-based. Enterprise SSO. IdP (Okta, Azure AD) autentica, genera assertion, SP (app) confía. Usado para web apps corporativas.","flow":"User → SP → redirect to IdP → authn → SAML assertion → SP validates → access granted","icon":"verified_user"},{"name":"OAuth 2.0","description":"RFC 6749. Authorization framework (no authn). Delegar acceso sin compartir password. Access tokens, refresh tokens. 'Login with Google/Facebook'. 4 flows: authorization code (más seguro), implicit (deprecated), client credentials, password grant.","use":"API access, third-party app authorization","icon":"vpn_key"},{"name":"OpenID Connect (OIDC)","description":"Authentication layer encima de OAuth 2.0. ID tokens (JWT) con user claims. Combina SSO + API authorization. Moderno, REST/JSON-based. Reemplaza SAML en apps nuevas.","icon":"badge"}],"okta_risk":"Okta es IdP centralizado. Si comprometido, atacante accede todas las apps conectadas. Single point of failure. Mitigate: MFA, PAM, least privilege en IdP admin."}},
  {"screen_id":4,"type":"practical_exercise","title":"Diseña IAM Architecture","content":{"scenario":"Empresa 500 empleados. Apps: Salesforce, Office 365, AWS, GitHub, Slack, internal HR app. Diseña SSO + Identity lifecycle.","requirements":["SSO para todas las apps","MFA enforced","Automated provisioning/deprovisioning","Access reviews quarterly","Privileged access management"],"your_design":{"idp":"Okta o Azure AD como Identity Provider central","authentication":"MFA required: TOTP app para users, FIDO2 para admins","sso_integration":["Salesforce: SAML 2.0","Office 365: OIDC/SAML","AWS: SAML federation + assume role","GitHub: SAML","Slack: SAML","Internal app: OIDC"],"lifecycle_automation":{"joiner":"HR system → IdP API → create user + assign default groups → notify manager","mover":"Manager request → approval workflow → modify group memberships → log change","leaver":"HR system (termination date) → auto-disable accounts same day → start deprovisioning workflow"},"pam":{"vault":"CyberArk or HashiCorp Vault para admin passwords","jit":"Just-in-time elevation para AWS/production","monitoring":"Alert on privileged access uso"},"governance":{"access_reviews":"Quarterly campaigns, managers approve/deny","reporting":"Who has access to what, compliance reports","audit":"All access changes logged in SIEM"}}}},
  {"screen_id":5,"type":"quiz","title":"Evaluación - IAM Systems","content":{"question":"En Okta breach, contractor tenía acceso a support tools. ¿Qué controles habrían ayudado?","options":[{"id":"a","text":"PAM con JIT access + session monitoring + stronger contractor vetting","is_correct":true,"feedback":"Correcto. Contractor no debía tener acceso permanente. JIT (temporal), session recording, background checks más rigurosos."},{"id":"b","text":"Solo deshabilitar SSO","is_correct":false,"feedback":"No. SSO es valioso. Problema era privileged access management del contractor."},{"id":"c","text":"Eliminar todos los contractors","is_correct":false,"feedback":"No es práctico. Mejor: treat contractors como high-risk, stronger controls, limited access, monitoring."}]}}
]