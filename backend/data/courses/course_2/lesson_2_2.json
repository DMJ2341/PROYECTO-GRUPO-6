[
  {
    "screen_id": 1,
    "type": "step_revelation",
    "title": "Caso: Capital One Breach (2019)",
    "duration": 200,
    "content": {
      "story_title": "Capital One: 100M Records via WAF Misconfiguration",
      "story_intro": "AWS WAF misconfiguration + SSRF = massive breach",
      "steps": [
        {
          "id": "1",
          "icon": "account_balance",
          "title": "El Target",
          "content": "Capital One, major US bank. Cloud-first en AWS. 100M+ customer applications, SSNs, credit scores en S3 buckets.",
          "insight": "Moving to cloud sin proper security = disaster. Cloud is secure, but YOU must configure it correctly."
        },
        {
          "id": "2",
          "icon": "bug_report",
          "title": "El Exploit: SSRF",
          "content": "Paige Thompson (ex-AWS employee) explotó SSRF (Server-Side Request Forgery) en WAF misconfigured. WAF tenía IAM role con demasiados permisos. SSRF → access metadata endpoint → steal credentials → access S3.",
          "insight": "SSRF + over-privileged IAM = keys to kingdom. Least privilege es CRÍTICO en cloud."
        },
        {
          "id": "3",
          "icon": "cloud_download",
          "title": "Exfiltración",
          "content": "Thompson exfiltró 100M+ records desde S3 buckets. Data: SSNs, credit scores, bank accounts, transaction history. Subió sample a GitHub (rookie mistake).",
          "insight": "DLP hubiera detectado exfiltration masiva. GitHub scanning encontró las credenciales leaked."
        },
        {
          "id": "4",
          "icon": "gavel",
          "title": "Aftermath",
          "content": "FBI arrestó Thompson. Capital One: $80M fine de reguladores, $190M en settlements. CISO despedido. Clase colectiva de lawsuits.",
          "insight": "Misconfiguration de firewall/WAF puede costar más que breach tradicional. Cloud amplifica el blast radius."
        }
      ]
    }
  },
  {
    "screen_id": 2,
    "type": "memory_cards",
    "title": "Tipos de Firewalls",
    "duration": 240,
    "content": {
      "description": "Evolución de firewall technology",
      "cards": [
        {
          "id": "1",
          "front": {
            "icon": "filter_alt",
            "term": "Packet Filtering (Stateless)",
            "color": "#757575"
          },
          "back": {
            "definition": "Generación 1 (legacy). Inspecciona header de cada packet individualmente. Rules basadas en: source/dest IP, port, protocol. No mantiene state de conexiones.",
            "example": "ACL en routers. Permite TCP port 80 from any to web server. Vulnerabilidad: No sabe si packet es parte de conexión legítima. Spoofing fácil.",
            "color": "#9E9E9E"
          }
        },
        {
          "id": "2",
          "front": {
            "icon": "memory",
            "term": "Stateful Inspection",
            "color": "#1976D2"
          },
          "back": {
            "definition": "Generación 2. Mantiene state table de conexiones activas. Verifica que packets sean parte de conexión legítima. Blocks unsolicited inbound traffic.",
            "example": "Permite outbound connection, automáticamente permite response. Cisco ASA, pfSense. Vulnerabilidad: No inspecciona application-layer payload.",
            "color": "#42A5F5"
          }
        },
        {
          "id": "3",
          "front": {
            "icon": "shield",
            "term": "Next-Gen Firewall (NGFW)",
            "color": "#388E3C"
          },
          "back": {
            "definition": "Generación 3. Deep packet inspection (DPI). Application awareness. IPS integrado. Malware detection. SSL/TLS inspection. Identity-aware.",
            "example": "Palo Alto, Fortinet, Check Point. Detecta malware en HTTP download. Blocks malicious domains. User-based policies. Capital One necesitaba NGFW.",
            "color": "#66BB6A"
          }
        },
        {
          "id": "4",
          "front": {
            "icon": "cloud",
            "term": "Web Application Firewall (WAF)",
            "color": "#F57C00"
          },
          "back": {
            "definition": "Especializado en proteger web apps. Layer 7 (HTTP/HTTPS). Protege contra: SQLi, XSS, CSRF, SSRF. Rules basadas en OWASP Top 10.",
            "example": "Cloudflare WAF, AWS WAF, ModSecurity. Capital One WAF estaba misconfigured: IAM role demasiado permissive. WAF debe seguir least privilege.",
            "color": "#FFB74D"
          }
        }
      ]
    }
  },
  {
    "screen_id": 3,
    "type": "progress_checklist",
    "title": "Firewall Rules: Best Practices",
    "duration": 300,
    "content": {
      "title": "Configuración Segura",
      "items": [
        {
          "id": "rule1",
          "task": "Default Deny",
          "subtitle": "Block everything, allow exceptions",
          "icon": "block",
          "unlock_content": {
            "title": "Principio Fundamental",
            "points": [
              "Implicit deny: Todo bloqueado por default",
              "Explicitly allow solo lo necesario",
              "Evita: Default allow (permit any any = desastre)",
              "Capital One: WAF permittió demasiado, no deny by default"
            ],
            "bonus_fact": "Firewall con default allow = no firewall. 90% de breaches involucran misconfigured firewalls."
          }
        },
        {
          "id": "rule2",
          "task": "Least Privilege",
          "subtitle": "Mínimos permisos necesarios",
          "icon": "vpn_key",
          "unlock_content": {
            "title": "Minimize Attack Surface",
            "points": [
              "Allow solo puertos/IPs específicos necesarios",
              "No usar 0.0.0.0/0 (any) sin justificación",
              "Review rules trimestralmente, remove obsoletas",
              "Capital One IAM role: S3 full access cuando solo read necesario"
            ],
            "bonus_fact": "Una rule demasiado permissive puede nulificar 100 rules restrictivas. Review es crítico."
          }
        },
        {
          "id": "rule3",
          "task": "Logging y Monitoring",
          "subtitle": "Visibility de todo el tráfico",
          "icon": "visibility",
          "unlock_content": {
            "title": "Detect Anomalies",
            "points": [
              "Log ALL firewall decisions (allow y deny)",
              "SIEM integration para correlation",
              "Alert on: Denied traffic spikes, geographic anomalies",
              "Capital One: Sin logging proper, breach no detectado por meses"
            ],
            "bonus_fact": "Firewall sin logging = blind. 70% de breaches detectados por terceros, no víctima."
          }
        }
      ]
    }
  },
  {
    "screen_id": 4,
    "type": "memory_cards",
    "title": "Network Segmentation",
    "duration": 180,
    "content": {
      "description": "Divide and conquer strategy",
      "cards": [
        {
          "id": "1",
          "front": {
            "icon": "widgets",
            "term": "DMZ (Demilitarized Zone)",
            "color": "#FF6F00"
          },
          "back": {
            "definition": "Zona intermedia entre internet y internal network. Servicios públicos (web, email, DNS) viven aquí. Si DMZ es compromised, internal network sigue protegida.",
            "example": "Firewall 1: Internet → DMZ. Firewall 2: DMZ → Internal. Web server en DMZ. Si hacked, no acceso a internal database servers.",
            "color": "#FFB74D"
          }
        },
        {
          "id": "2",
          "front": {
            "icon": "lan",
            "term": "VLANs (Virtual LANs)",
            "color": "#1976D2"
          },
          "back": {
            "definition": "Segmentación lógica de network. Devices en diferentes VLANs no pueden comunicarse sin router/firewall. Isolation sin separación física.",
            "example": "VLAN 10: Guest WiFi. VLAN 20: Employees. VLAN 30: Servers. Guest no puede reach servers. Mirai: flat networks permitieron propagation.",
            "color": "#42A5F5"
          }
        }
      ]
    }
  },
  {
    "screen_id": 5,
    "type": "quiz",
    "title": "Evaluación - Firewalls",
    "duration": 90,
    "content": {
      "question": "Capital One breach: ¿Cuál fue el error fundamental?",
      "options": [
        {
          "id": "a",
          "text": "No tenían firewall",
          "is_correct": false,
          "feedback": "Incorrecto. Capital One tenía WAF (Web Application Firewall). El problema no fue ausencia sino misconfiguration."
        },
        {
          "id": "b",
          "text": "WAF con IAM role demasiado permissive + SSRF vulnerability",
          "is_correct": true,
          "feedback": "CORRECTO! WAF tenía IAM role con S3 full access (violación de least privilege). Atacante explotó SSRF para acceder metadata endpoint, steal credentials del IAM role, y usar esas credentials para download S3 buckets completos. Dos errores: 1) Over-privileged IAM, 2) SSRF not blocked."
        },
        {
          "id": "c",
          "text": "Usaron firewall stateless en vez de stateful",
          "is_correct": false,
          "feedback": "Incorrecto. Tipo de firewall no fue el issue. WAF es application-layer (layer 7). Problema fue misconfiguration de permisos."
        }
      ]
    }
  }
]